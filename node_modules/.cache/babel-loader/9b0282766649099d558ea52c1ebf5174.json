{"ast":null,"code":"import _regeneratorRuntime from\"/Users/godspeed/Desktop/caglarturali.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/godspeed/Desktop/caglarturali.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/godspeed/Desktop/caglarturali.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/godspeed/Desktop/caglarturali.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";/**\n * Generic GHButton component.\n */import React,{useState,useEffect}from'react';import{useLocalStorageState}from'../../hooks';import ButtonLink from'../ButtonLink';import{buildRecordObject,isRecordUsable}from'../../utils';var GHButton=function GHButton(_ref){var _ref$resource=_ref.resource,attr=_ref$resource.attr,endpoint=_ref$resource.endpoint,_ref$timeout=_ref.timeout,timeout=_ref$timeout===void 0?10:_ref$timeout,btnProps=_objectWithoutProperties(_ref,[\"resource\",\"timeout\"]);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useLocalStorageState=useLocalStorageState(attr,undefined),_useLocalStorageState2=_slicedToArray(_useLocalStorageState,2),attrCountRecord=_useLocalStorageState2[0],setAttrCountRecord=_useLocalStorageState2[1];useEffect(function(){var fetchApi=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,json;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(endpoint);case 2:response=_context.sent;_context.next=5;return response.json();case 5:json=_context.sent;if(json[attr]>=0){setAttrCountRecord(buildRecordObject(json[attr]));}setLoading(false);case 8:case\"end\":return _context.stop();}}},_callee);}));return function fetchApi(){return _ref2.apply(this,arguments);};}();if(!isRecordUsable(attrCountRecord,timeout)){fetchApi();}});return/*#__PURE__*/React.createElement(ButtonLink,Object.assign({},btnProps,{showCount:!loading&&attrCountRecord!==undefined,count:attrCountRecord.data}));};export default GHButton;","map":{"version":3,"sources":["/Users/godspeed/Desktop/caglarturali.github.io/src/components/GHButton/index.tsx"],"names":["React","useState","useEffect","useLocalStorageState","ButtonLink","buildRecordObject","isRecordUsable","GHButton","resource","attr","endpoint","timeout","btnProps","loading","setLoading","undefined","attrCountRecord","setAttrCountRecord","fetchApi","fetch","response","json","data"],"mappings":"qqBAAA;AACA;AACA,GACA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,oBAAT,KAAqC,aAArC,CACA,MAAOC,CAAAA,UAAP,KAA4C,eAA5C,CAEA,OAASC,iBAAT,CAA4BC,cAA5B,KAAkD,aAAlD,CASA,GAAMC,CAAAA,QAAmD,CAAG,QAAtDA,CAAAA,QAAsD,MAItD,wBAHJC,QAGI,CAHQC,IAGR,eAHQA,IAGR,CAHcC,QAGd,eAHcA,QAGd,mBAFJC,OAEI,CAFJA,OAEI,uBAFM,EAEN,cADDC,QACC,qEAC0BX,QAAQ,CAAC,KAAD,CADlC,wCACGY,OADH,eACYC,UADZ,yCAE0CX,oBAAoB,CAEhEM,IAFgE,CAE1DM,SAF0D,CAF9D,gEAEGC,eAFH,2BAEoBC,kBAFpB,2BAMJf,SAAS,CAAC,UAAM,CACd,GAAMgB,CAAAA,QAAQ,2FAAG,2KACQC,CAAAA,KAAK,CAACT,QAAD,CADb,QACTU,QADS,qCAEIA,CAAAA,QAAQ,CAACC,IAAT,EAFJ,QAETA,IAFS,eAIf,GAAIA,IAAI,CAACZ,IAAD,CAAJ,EAAc,CAAlB,CAAqB,CACnBQ,kBAAkB,CAACZ,iBAAiB,CAACgB,IAAI,CAACZ,IAAD,CAAL,CAAlB,CAAlB,CACD,CAEDK,UAAU,CAAC,KAAD,CAAV,CARe,sDAAH,kBAARI,CAAAA,QAAQ,2CAAd,CAWA,GAAI,CAACZ,cAAc,CAACU,eAAD,CAAkBL,OAAlB,CAAnB,CAA+C,CAC7CO,QAAQ,GACT,CACF,CAfQ,CAAT,CAiBA,mBACE,oBAAC,UAAD,kBACMN,QADN,EAEE,SAAS,CAAE,CAACC,OAAD,EAAYG,eAAe,GAAKD,SAF7C,CAGE,KAAK,CAAEC,eAAe,CAACM,IAHzB,GADF,CAOD,CAlCD,CAoCA,cAAef,CAAAA,QAAf","sourcesContent":["/**\n * Generic GHButton component.\n */\nimport React, { useState, useEffect } from 'react';\nimport { useLocalStorageState } from '../../hooks';\nimport ButtonLink, { ButtonLinkProps } from '../ButtonLink';\nimport { LocalCache } from '../../models';\nimport { buildRecordObject, isRecordUsable } from '../../utils';\n\nexport interface GHButtonProps extends ButtonLinkProps {\n  resource: {\n    endpoint: string;\n    attr: string;\n  };\n}\n\nconst GHButton: React.FC<GHButtonProps & LocalCache.Prop> = ({\n  resource: { attr, endpoint },\n  timeout = 10, // 10 mins\n  ...btnProps\n}) => {\n  const [loading, setLoading] = useState(false);\n  const [attrCountRecord, setAttrCountRecord] = useLocalStorageState<\n    number | undefined\n  >(attr, undefined);\n\n  useEffect(() => {\n    const fetchApi = async (): Promise<any> => {\n      const response = await fetch(endpoint);\n      const json = await response.json();\n\n      if (json[attr] >= 0) {\n        setAttrCountRecord(buildRecordObject(json[attr]));\n      }\n\n      setLoading(false);\n    };\n\n    if (!isRecordUsable(attrCountRecord, timeout)) {\n      fetchApi();\n    }\n  });\n\n  return (\n    <ButtonLink\n      {...btnProps}\n      showCount={!loading && attrCountRecord !== undefined}\n      count={attrCountRecord.data}\n    />\n  );\n};\n\nexport default GHButton;\n"]},"metadata":{},"sourceType":"module"}